@page
@model webclinic.Pages.DrProfileModel
@{
    ViewData["Title"] = "Doctor Profile";
    Layout = ".\\Shared\\_Layout.cshtml";
}



<div class="header-inner">
            <div class="container">
                <div class="inner">
                    <div class="row">
                        <div class="col-lg-3 col-md-3 col-12">
                            <div class="logo">
                                <a href="index"><img src="img/logo.png" alt="#"></a>
                            </div>
                            <div class="mobile-nav"></div>
                        </div>
                        <div class="col-lg-7 col-md-9 col-12">
                            <div class="main-menu">
                                <nav class="navigation">
                                    <ul class="nav menu">
                                        <li><a href="index">Home</a></li>
                                        <li><a href="#">Pages <i class="icofont-rounded-down"></i></a>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                    </div>
                </div>
            </div>
        </div>
    </header>
<!-- Breadcrumbs -->
<div class="breadcrumbs overlay">
    <div class="container">
        <div class="bread-inner">
            <div class="row">
                <div class="col-12">
                    <h2>My Profile</h2>
                    <ul class="bread-list">
                        <li><a href="Index">Home</a></li>
                        <li><i class="icofont-simple-right"></i></li>
                        <li class="active">My Profile</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- End Breadcrumbs -->



<div class="container my-5">
    <!-- Profile Section -->
    <div class="row mb-5 align-items-center">
        <div class="col-md-3 text-center">
            <img src="@Model.DoctorImage" alt="Doctor's Profile Image" class="rounded-circle" style="width: 180px; height: 180px;" />
        </div>
        <div class="col-md-9">
            <h2>@Model.DoctorName</h2>
            <p class="text-muted">@Model.Specialization</p>
            <div class="ratings mb-3">
                <p><strong>Rating:</strong> @Model.Rating/5</p>
                <p><strong>Patients Treated:</strong> @Model.PatientsTreated</p>
                @if (HttpContext.Session.GetString("user_type") == "a")
{
        <span class="badge text-white @(Model.IsActivated ? "bg-success" : "bg-warning text-dark")">
                        @(Model.IsActivated ? "Active" : "Banned")
        </span>
            <span class="badge text-white @(Model.IsVerified ? "bg-success" : "bg-warning text-dark")">
                        @(Model.IsVerified ? "Verified" : "Unverified")
            </span>

}

            </div>

            <p>Age: @Model.Age</p>
        </div>
    </div>
    @if (HttpContext.Session.GetString("user_type") == "a")
    {
    <div class="d-flex justify-content-end gap-5">
        <form method="post" asp-page-handler="ToggleStatus">
            <button type="submit" class="btn @(Model.IsActivated ? "btn-danger" : "btn-success") btn-lg px-4">
                    @(Model.IsActivated ? "Ban" : "Activate")
            </button>
        </form>

        <form method="post" asp-page-handler="ToggleSSSN">
            <button type="submit" class="btn @(Model.IsVerified ? "btn-danger" : "btn-success") btn-lg px-4">
                    @(Model.IsVerified ? "Unverify" : "Verify")
            </button>
        </form>
    </div>




    }
    <!-- Education Section -->
    <div class="mb-5">
        <h5 class="mb-3">Education 
            <a href="#" class="ms-2 text-decoration-none">✎</a>
        </h5>
        <div class="row g-3">
            @for (int i = 0; i < Model.education.Rows.Count; i++)
            {
                <div class="col-md-6">
                    <div class="p-3 border rounded">
                                    <h6 class="mb-1">@Model.education.Rows[i]["Institute"].ToString()</h6>
                                <p class="text-muted">@Model.education.Rows[i]["Description"].ToString()</p>
                    </div>
                </div>
            }
        </div>
    </div>

    <!-- Experience Section -->
    <div class="mb-5">
        <h5 class="mb-3">Experience 
            <a href="#" class="ms-2 text-decoration-none">✎</a>
        </h5>
        <div class="row g-3">
            @for (int i = 0; i < Model.experiance.Rows.Count; i++)
            {
                <div class="col-md-6">
                    <div class="p-3 border rounded">
                                <h6 class="mb-1">@Model.experiance.Rows[i]["Institution"].ToString()</h6>
                                <p class="text-muted">@Model.experiance.Rows[i]["JobPosition"].ToString()</p>
                    </div>
                </div>
            }
        </div>
    </div>

    <!-- Clinic Section -->
    <div class="mb-5">
        <h5 class="mb-3">Clinic Details 
            <a href="#" class="ms-2 text-decoration-none">✎</a>
        </h5>
        <div class="row">
            <div class="col-md-12">
                <p><strong>@Model.ClinicDetails.Rows[0]["Institution"].ToString()</strong></p>
                <p>@Model.ClinicDetails.Rows[0]["address"].ToString()</p>
            </div>
        </div>
    </div>


   
<!-- Booking Information Section -->
    <div class="row mb-5">
        <div class="col-md-6">
            <div class="p-4 border rounded">
                <h5 class="mb-3">Booking Information 
                    <a href="#" class="ms-2 text-decoration-none">✎</a>
                </h5>
                <p class="h4 text-primary">@Model.Fee</p>
            </div>
        </div>
        

        <div class="col-md-6">
            </div>
        </div>
        <!-- Add Dates and Available Times Table -->
<div class="mb-3">
    <p class="text-muted">Add Dates and Available Times</p>
    <hr class="my-2">
    <table class="table table-bordered">
        <thead>
            <tr>
                <th scope="col">Date</th>
                <th scope="col">Available Times</th>
            </tr>
        </thead>
        <tbody>
                @for (int i = 0; i < Model.dates.Rows.Count; i++)
                {
                    DateTime dateValue = Convert.ToDateTime(Model.dates.Rows[i]["date"]);
                        <tr>
                            <td>@dateValue.ToString("MM/dd dddd")</td>
                            <td>
                            @* Fetch available times for this date *@
                            @{
                                var times = Model.gettimes(dateValue);
                            }
                            @* Loop through available times and display as buttons *@
                            @for (int j = 0; j < times.Rows.Count; j++)
                            {
                                            <button class="btn btn-outline-secondary time-slot-btn" data-toggle="modal" data-target="#bookTimeModal">
                                    @times.Rows[j]["time"].ToString()
                                            </button>

                            }
                            </td>
                        </tr>
                }
        </tbody>
    </table>
        @if (HttpContext.Session.GetString("user_type") == "d")
        {
                            <!-- Add Button -->
                            <button class="btn btn-outline-primary w-100 mt-3" data-toggle="modal" data-target="#addTimeModal">
                                + Add Time
                        </button>
        }
</div>
    </div>
</div>






@if (HttpContext.Session.GetString("user_type") == "d")
{
    <!-- Modal for Add Time -->
    <div class="modal fade" id="bookTimeModal" tabindex="-1" role="dialog" aria-labelledby="addTimeModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addTimeModalLabel">Add Available Time</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <input type="time" class="form-control" id="newTime" />
                </div>
                <div class="modal-body">
                    <input type="date" class="form-control" id="newDate" />
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">Save Time</button>
                </div>
            </div>
        </div>
    </div>
}




<!-- Modal for Add Time -->
<div class="modal fade" id="addTimeModal" tabindex="-1" role="dialog" aria-labelledby="addTimeModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addTimeModalLabel">Add Available Time</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <input type="time" class="form-control" id="newTime" />
            </div>
            <div class="modal-body">
                <input type="date" class="form-control" id="newDate" />
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save Time</button>
            </div>
        </div>
    </div>
</div>

<!-- Inline Styling -->
<style>
    /* Increased size of the available time buttons and borders */
    .time-slot-btn {
        background-color: #fff;
        border: 2px solid #ddd;
        padding: 15px 25px;  /* Increased padding */
        margin: 5px;
        border-radius: 10px;
        cursor: pointer;
        font-size: 16px;
        font-weight: bold;
        transition: all 0.3s ease;
    }

    .time-slot-btn:hover {
        background-color: #00BFAE;
        color: white;
    }

    /* Add lines for "Add Dates" and "Add Available Time" */
    hr {
        border-top: 2px solid #ddd;
    }

    /* Adjustments for text color and positioning */
    .text-muted {
        color: #6c757d;
        font-weight: bold;
    }

    /* Custom styling for the buttons */
    .btn-outline-secondary {
        border-color: #ddd;
        color: #555;
        font-weight: normal;
    }

    .btn-outline-secondary:hover {
        background-color: #f8f9fa;
    }

    .btn-outline-primary {
        border-color: #00BFAE;
        color: #00BFAE;
    }

    .btn-outline-primary:hover {
        background-color: #00BFAE;
        color: white;
    }
</style>